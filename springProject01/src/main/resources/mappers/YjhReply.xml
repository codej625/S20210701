<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ReplyDao">

<!-- 	postReplyList -->
	<select id="postReplyList" parameterType="Reply" resultType="Reply">
		select  r.*, m.m_name, m.m_tel
		from    reply r, member m
		where   (r.bt_num =  #{bt_num} and r.bc_num = #{bc_num} and r.p_num = #{p_num}) and r.m_id = m.m_id
		order by bt_num,bc_num,p_num,r_num desc
	</select>
	
<!-- 	replyInsert -->
	<insert id="replyInsert" parameterType="Reply">
		insert into reply
				(bt_num, bc_num, p_num, r_num, r_rate, r_indent, r_group, r_info, r_writedate)
		values (#{bt_num},#{bc_num},#{p_num},Reply_max( #{bt_num}, #{bc_num},#{p_num}),
				#{r_rate},#{r_indent},Reply_max( #{bt_num}, #{bc_num},#{p_num}),#{r_info},sysdate)
	</insert>

</mapper>